<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ol/control/HtmlTemplate.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ol/control/HtmlTemplate.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module webgis4u/ol/control/HtmlTemplate
 */

import Control from 'ol/control/Control';

import { toggleElement } from '../../util/dom/toggleElement';

import {
  OL_CONTROL_ZOOM_CSS_CLASS_MOUSE_POSITION,
  OL_CONTROL_ZOOM_CSS_CLASS_ZOOM,
  OL_CONTROL_ZOOM_CSS_CLASS_ZOOMSLIDER,
  CSS_PREFIX,
} from './common';

import { CSS_CLASS as PanBarCssClass } from './PanBar';
import { CSS_CLASS as ScaleLineCssClass } from './ScaleLine';

import ToolSwitcher from './HtmlTemplate/ToolSwitcher/ToolSwitcher';
import InfoPanel from './HtmlTemplate/InfoPanel/InfoPanel';

import './HtmlTemplate/HtmlTemplate.scss';
import { createElement } from '../../util/dom/createElement';
import { getMapType, MapTypeEnum } from '../util/getMapType';

/**
 * The css class for the element 'copy right'
 */
const CSS_CLASS_COPYRIGHT = `${CSS_PREFIX}-map-copyright`;
/**
 * The css class for the element 'footer'
 */
const CSS_CLASS_FOOTER = `${CSS_PREFIX}-map-footer`;

/**
 * Toggles element visibility if the element exists
 * @param {HTMLElement|undefined} element
 * @param {boolean|undefined} toggle
 */
function secureToggleElement(element, toggle) {
  if (element) { toggleElement(element, toggle); }
}

/**
 * Glues the map template with the map together.
 *
 * @extends {ol.control.Control}
 */
class HtmlTemplate extends Control {
  /**
   * The minimum height needed to display the navbar
   */
  static MIN_NAVBAR_DISPLAYHEIGHT = 100;

  /**
   * The minimum width needed to display the navbar
   */
  static MIN_NAVBAR_DISPLAYWIDTH = 100;

  /**
   * The minimum height needed to display the footer
   */
  static MIN_MAPFOOTER_DISPLAYHEIGHT = 1000;

  /** @type {HTMLElement} */
  mapEl;

  /** @type {HTMLElement|null} */
  scaleLineCheckbox = null;

  /** @type {HTMLElement|null} */
  scaleLine = null;

  /** @type {HTMLElement|null} */
  scaleSlider = null;

  /** @type {HTMLElement|null} */
  panBar = null;

  /** @type {HTMLElement|null} */
  mousePosCheckbox = null;

  /** @type {HTMLElement|null} */
  mousePos = null;

  /** @type {HTMLElement|null} */
  mapCopyright = null;

  /** @type {HTMLElement} */
  mapFooter = null;

  infoPanel = new InfoPanel();

  toolSwitcher = new ToolSwitcher();

  /**
   * Constructor
   * @param {*} options The options
   */
  constructor(options) {
    /* creates the dom element */
    const element = document.createElement('div');
    const elementFooter = createElement({ tag: 'div', cssClass: CSS_CLASS_FOOTER });
    element.appendChild(elementFooter);

    super({
      element,
      ...options,
    });

    this.mapFooter = elementFooter;
    window.addEventListener('resize', this.updateControlsVisibility);
  }

  /**
   * @inheritDoc
   */
  setMap(map) {
    super.setMap(map);

    // If no map is present there is nothin more to do
    if (!map) { return; }

    /**
     * @type {HTMLElement}
     */
    const mapEl = map.getTargetElement();
    this.mapEl = mapEl;

    // Find map elements
    this.mousePosCheckbox = mapEl.querySelector('input[name="webgis4uDisplayMousePosition"]');
    this.scaleLineCheckbox = mapEl.querySelector('input[name="webgis4uScaleLine"]');

    // Find the map controls
    // Find the webgis4u controls
    this.scaleLine = mapEl.querySelector(`.${ScaleLineCssClass}`);
    this.panBar = mapEl.querySelector(`.${PanBarCssClass}`);
    // Find the OL controls
    this.mousePos = mapEl.querySelector(`.${OL_CONTROL_ZOOM_CSS_CLASS_MOUSE_POSITION}`);
    this.zoom = mapEl.querySelector(`.${OL_CONTROL_ZOOM_CSS_CLASS_ZOOM}`);
    this.scaleSlider = mapEl.querySelector(`.${OL_CONTROL_ZOOM_CSS_CLASS_ZOOMSLIDER}`);

    // Find map elements
    this.mapCopyright = mapEl.querySelector(`.${CSS_CLASS_COPYRIGHT}`);

    // enable display / not display mouse position
    if (this.mousePosCheckbox &amp;&amp; this.mousePos) {
      this.mousePosCheckbox.onchange = (e => toggleElement(this.mousePos, e.target.checked));
    }

    // enable display / not display scale line
    if (this.scaleLineCheckbox &amp;&amp; this.scaleLine) {
      this.scaleLineCheckbox.onchange = (e => toggleElement(this.scaleLine, e.target.checked));
    }

    this.toolSwitcher.init(mapEl);
    this.infoPanel.init(map);
    this.updateControlsVisibility();
  }

  /**
   * Updates the visibility for the controls
   * @private
   */
  updateControlsVisibility = () => {
    const map = this.getMap();

    // do it only for the large map
    if (!map || getMapType(map) !== MapTypeEnum.Large) { return; }

    const size = map.getSize();
    if (!size) { return; }

    const [width, height] = size;

    const toggle = (
      height > HtmlTemplate.MIN_NAVBAR_DISPLAYHEIGHT
      &amp;&amp; width > HtmlTemplate.MIN_NAVBAR_DISPLAYWIDTH
    );
    secureToggleElement(this.scaleSlider, toggle);
    secureToggleElement(this.zoom, toggle);
    secureToggleElement(this.panBar, toggle);

    const toggle2 = (height > HtmlTemplate.MIN_MAPFOOTER_DISPLAYHEIGHT);
    secureToggleElement(this.mapFooter, toggle2);
    secureToggleElement(this.mousePos, toggle2);
    secureToggleElement(this.scaleLine, toggle2);
    secureToggleElement(this.mapCopyright, toggle2);

    this.toolSwitcher.updateControlsVisibility({ size });
  }
}

export default HtmlTemplate;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-webgis4u.html">webgis4u</a></li><li><a href="module-webgis4u_components.html">webgis4u/components</a></li><li><a href="module-webgis4u_components_AutoComplete.html">webgis4u/components/AutoComplete</a></li><li><a href="module-webgis4u_ol.html">webgis4u/ol</a></li><li><a href="module-webgis4u_ol_common.html">webgis4u/ol/common</a></li><li><a href="module-webgis4u_ol_control.html">webgis4u/ol/control</a></li><li><a href="module-webgis4u_ol_control_AbstractLayerRelatedControl.html">webgis4u/ol/control/AbstractLayerRelatedControl</a></li><li><a href="module-webgis4u_ol_control_AbstractLayerRelatedElementControl.html">webgis4u/ol/control/AbstractLayerRelatedElementControl</a></li><li><a href="module-webgis4u_ol_control_common.html">webgis4u/ol/control/common</a></li><li><a href="module-webgis4u_ol_control_HtmlTemplate.html">webgis4u/ol/control/HtmlTemplate</a></li><li><a href="module-webgis4u_ol_control_HtmlTemplate_InfoPanel.html">webgis4u/ol/control/HtmlTemplate/InfoPanel</a></li><li><a href="module-webgis4u_ol_control_HtmlTemplate_ToolSwitcher.html">webgis4u/ol/control/HtmlTemplate/ToolSwitcher</a></li><li><a href="module-webgis4u_ol_control_LayerCheckbox.html">webgis4u/ol/control/LayerCheckbox</a></li><li><a href="module-webgis4u_ol_control_LayerRadioButton.html">webgis4u/ol/control/LayerRadioButton</a></li><li><a href="module-webgis4u_ol_control_LegendDisplayable.html">webgis4u/ol/control/LegendDisplayable</a></li><li><a href="module-webgis4u_ol_control_LegendVisibility.html">webgis4u/ol/control/LegendVisibility</a></li><li><a href="module-webgis4u_ol_control_Measure.html">webgis4u/ol/control/Measure</a></li><li><a href="module-webgis4u_ol_control_OverviewMap.html">webgis4u/ol/control/OverviewMap</a></li><li><a href="module-webgis4u_ol_control_PanBar.html">webgis4u/ol/control/PanBar</a></li><li><a href="module-webgis4u_ol_control_ScaleLine.html">webgis4u/ol/control/ScaleLine</a></li><li><a href="module-webgis4u_ol_control_Search.html">webgis4u/ol/control/Search</a></li><li><a href="module-webgis4u_ol_control_util.html">webgis4u/ol/control/util</a></li><li><a href="module-webgis4u_ol_proj.html">webgis4u/ol/proj</a></li><li><a href="module-webgis4u_ol_proj_austria.html">webgis4u/ol/proj/austria</a></li><li><a href="module-webgis4u_ol_proj_reproject.html">webgis4u/ol/proj/reproject</a></li><li><a href="module-webgis4u_ol_source.html">webgis4u/ol/source</a></li><li><a href="module-webgis4u_ol_source_basemap.html">webgis4u/ol/source/basemap</a></li><li><a href="module-webgis4u_ol_source_basemap_common.html">webgis4u/ol/source/basemap/common</a></li><li><a href="module-webgis4u_ol_style.html">webgis4u/ol/style</a></li><li><a href="module-webgis4u_ol_style_color.html">webgis4u/ol/style/color</a></li><li><a href="module-webgis4u_ol_style_style.html">webgis4u/ol/style/style</a></li><li><a href="module-webgis4u_ol_util.html">webgis4u/ol/util</a></li><li><a href="module-webgis4u_ol_util_changeMapTarget.html">webgis4u/ol/util/changeMapTarget</a></li><li><a href="module-webgis4u_ol_util_createImageFromMap.html">webgis4u/ol/util/createImageFromMap</a></li><li><a href="module-webgis4u_ol_util_getMapChildElementByClassName.html">webgis4u/ol/util/getMapChildElementByClassName</a></li><li><a href="module-webgis4u_ol_util_getMapType.html">webgis4u/ol/util/getMapType</a></li><li><a href="module-webgis4u_ol_util_getScale.html">webgis4u/ol/util/getScale</a></li><li><a href="module-webgis4u_ol_util_pan.html">webgis4u/ol/util/pan</a></li><li><a href="module-webgis4u_ol_util_print.html">webgis4u/ol/util/print</a></li><li><a href="module-webgis4u_ol_util_zoomToExtent.html">webgis4u/ol/util/zoomToExtent</a></li><li><a href="module-webgis4u_ol_util_zoomToLayerExtent.html">webgis4u/ol/util/zoomToLayerExtent</a></li><li><a href="module-webgis4u_util.html">webgis4u/util</a></li><li><a href="module-webgis4u_util_dom.html">webgis4u/util/dom</a></li><li><a href="module-webgis4u_util_dom_createElement.html">webgis4u/util/dom/createElement</a></li><li><a href="module-webgis4u_util_dom_KeyCodeEnum.html">webgis4u/util/dom/KeyCodeEnum</a></li><li><a href="module-webgis4u_util_dom_toggleElement.html">webgis4u/util/dom/toggleElement</a></li><li><a href="module-webgis4u_util_function.html">webgis4u/util/function</a></li><li><a href="module-webgis4u_util_function_debounce.html">webgis4u/util/function/debounce</a></li><li><a href="module-webgis4u_util_number.html">webgis4u/util/number</a></li><li><a href="module-webgis4u_util_number_convertUnitValue.html">webgis4u/util/number/convertUnitValue</a></li><li><a href="module-webgis4u_util_promise.html">webgis4u/util/promise</a></li><li><a href="module-webgis4u_util_promise_asyncDebounce.html">webgis4u/util/promise/asyncDebounce</a></li><li><a href="module-webgis4u_util_promise_state.html">webgis4u/util/promise/state</a></li><li><a href="module-webgis4u_util_string.html">webgis4u/util/string</a></li><li><a href="module-webgis4u_util_string_formatNumber.html">webgis4u/util/string/formatNumber</a></li><li><a href="module-webgis4u_util_string_formatText.html">webgis4u/util/string/formatText</a></li><li><a href="module-webgis4u_util_string_formatUnitValue.html">webgis4u/util/string/formatUnitValue</a></li><li><a href="module-webgis4u_util_string_hasValue.html">webgis4u/util/string/hasValue</a></li><li><a href="module-webgis4u_util_web.html">webgis4u/util/web</a></li><li><a href="module-webgis4u_util_web_encodeQueryData.html">webgis4u/util/web/encodeQueryData</a></li><li><a href="module-webgis4u_util_web_sendRequest.html">webgis4u/util/web/sendRequest</a></li></ul><h3>Classes</h3><ul><li><a href="ClusterZoom.html">ClusterZoom</a></li><li><a href="module-webgis4u_components_AutoComplete-AutoComplete.html">AutoComplete</a></li><li><a href="module-webgis4u_ol_control_AbstractLayerRelatedControl-AbstractLayerRelatedControl.html">AbstractLayerRelatedControl</a></li><li><a href="module-webgis4u_ol_control_AbstractLayerRelatedElementControl-AbstractLayerRelatedElementControl.html">AbstractLayerRelatedElementControl</a></li><li><a href="module-webgis4u_ol_control_HtmlTemplate_InfoPanel-InfoPanel.html">InfoPanel</a></li><li><a href="module-webgis4u_ol_control_HtmlTemplate_ToolSwitcher-ToolSwitcher.html">ToolSwitcher</a></li><li><a href="module-webgis4u_ol_control_HtmlTemplate-HtmlTemplate.html">HtmlTemplate</a></li><li><a href="module-webgis4u_ol_control_LayerCheckbox-LayerCheckbox.html">LayerCheckbox</a></li><li><a href="module-webgis4u_ol_control_LayerRadioButton-LayerRadioButton.html">LayerRadioButton</a></li><li><a href="module-webgis4u_ol_control_LegendDisplayable-LegendDisplayable.html">LegendDisplayable</a></li><li><a href="module-webgis4u_ol_control_LegendVisibility-LegendVisibility.html">LegendVisibility</a></li><li><a href="module-webgis4u_ol_control_Measure-Measure.html">Measure</a></li><li><a href="module-webgis4u_ol_control_OverviewMap-OverviewMap.html">OverviewMap</a></li><li><a href="module-webgis4u_ol_control_PanBar-PanBar.html">PanBar</a></li><li><a href="module-webgis4u_ol_control_ScaleLine-ScaleLine.html">ScaleLine</a></li><li><a href="module-webgis4u_ol_control_Search-Search.html">Search</a></li><li><a href="module-webgis4u_ol_source_basemap.Color.html">Color</a></li><li><a href="module-webgis4u_ol_source_basemap.Gray.html">Gray</a></li><li><a href="module-webgis4u_ol_source_basemap.Orthofoto.html">Orthofoto</a></li><li><a href="module-webgis4u_ol_source_basemap.Overlay.html">Overlay</a></li></ul><h3>Global</h3><ul><li><a href="global.html#fromExtents">fromExtents</a></li><li><a href="global.html#fromFeatures">fromFeatures</a></li><li><a href="global.html#fromPixel">fromPixel</a></li><li><a href="global.html#getFeaturesAtPixel">getFeaturesAtPixel</a></li><li><a href="global.html#getFeaturesFromClusterFeature">getFeaturesFromClusterFeature</a></li><li><a href="global.html#getPseudoCenter">getPseudoCenter</a></li><li><a href="global.html#isDisplayable">isDisplayable</a></li><li><a href="global.html#isVisible">isVisible</a></li><li><a href="global.html#isVisibleForMap">isVisibleForMap</a></li><li><a href="global.html#isVisibleInView">isVisibleInView</a></li><li><a href="global.html#toggleInteraction">toggleInteraction</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Mon Dec 30 2019 11:39:34 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
